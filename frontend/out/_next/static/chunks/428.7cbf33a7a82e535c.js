"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[428],{1047:(e,s,t)=>{t.r(s),t.d(s,{default:()=>i});var a=t(5155),r=t(2115),l=t(273);function i(e){let{onClose:s,currentContext:t,advisorSuggestions:i}=e,[n,c]=(0,r.useState)(""),[o,d]=(0,r.useState)([]),[x,h]=(0,r.useState)([]),[p,g]=(0,r.useState)(!1),[u,m]=(0,r.useState)("propose");(0,r.useEffect)(()=>{y();let e=setInterval(y,5e3);return()=>clearInterval(e)},[]);let y=async()=>{try{let e=await fetch("/api/research/pending");if(e.ok){let s=await e.json();d(s.pending||[]),h(s.completed||[])}}catch(e){console.error("Failed to fetch research requests:",e)}},b=async()=>{if(n.trim()){g(!0);try{let e=await fetch("/api/research/propose",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n,context:t,advisor_suggestions:i})});e.ok&&(await e.json(),c(""),m("pending"),await y())}catch(e){console.error("Failed to propose research:",e)}finally{g(!1)}}},f=async(e,s)=>{try{(await fetch("/api/research/".concat(s?"approve":"deny"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({request_id:e})})).ok&&s&&await fetch("/api/research/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({request_id:e})}),await y()}catch(e){console.error("Failed to handle approval:",e)}};return(0,a.jsx)(l.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(l.P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-gray-900 rounded-2xl p-6 max-w-4xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Research Agent"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"flex space-x-2 mb-6",children:[(0,a.jsx)("button",{onClick:()=>m("propose"),className:"px-4 py-2 rounded-lg transition-colors ".concat("propose"===u?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"),children:"Propose Research"}),(0,a.jsxs)("button",{onClick:()=>m("pending"),className:"px-4 py-2 rounded-lg transition-colors relative ".concat("pending"===u?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"),children:["Pending Approval",o.length>0&&(0,a.jsx)("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:o.length})]}),(0,a.jsx)("button",{onClick:()=>m("completed"),className:"px-4 py-2 rounded-lg transition-colors ".concat("completed"===u?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"),children:"Completed"})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto",children:["propose"===u&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Research Query"}),(0,a.jsx)("textarea",{value:n,onChange:e=>c(e.target.value),placeholder:"What would you like to research?",className:"w-full px-4 py-3 bg-gray-800 text-white rounded-lg resize-none h-32 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.length>0&&(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:"Advisor Suggestions"}),(0,a.jsx)("div",{className:"space-y-2",children:i.map((e,s)=>(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("span",{className:"text-blue-400 font-medium",children:[e.advisor,":"]}),(0,a.jsx)("span",{className:"text-gray-300 ml-2",children:e.suggestion})]},s))})]}),(0,a.jsx)("button",{onClick:b,disabled:p||!n.trim(),className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Proposing...":"Propose Research"})]}),"pending"===u&&(0,a.jsx)("div",{className:"space-y-4",children:0===o.length?(0,a.jsx)("div",{className:"text-center text-gray-400 py-8",children:"No pending research requests"}):o.map(e=>{var s;return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-white font-medium mb-1",children:"Research Query"}),(0,a.jsx)("p",{className:"text-gray-300 text-sm",children:e.query})]}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["Est. cost: $",null==(s=e.cost_estimate)?void 0:s.toFixed(3)]})]}),e.refined_query&&(0,a.jsxs)("div",{className:"mb-3 p-3 bg-gray-700/50 rounded",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-300 mb-1",children:"Refined Query"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:e.refined_query})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>f(e.id,!0),className:"flex-1 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",children:"Approve & Execute"}),(0,a.jsx)("button",{onClick:()=>f(e.id,!1),className:"flex-1 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Deny"})]})]},e.id)})}),"completed"===u&&(0,a.jsx)("div",{className:"space-y-4",children:0===x.length?(0,a.jsx)("div",{className:"text-center text-gray-400 py-8",children:"No completed research requests"}):x.map(e=>(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("h3",{className:"text-white font-medium",children:e.query}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat("completed"===e.status?"bg-green-600/20 text-green-400":"failed"===e.status?"bg-red-600/20 text-red-400":"bg-gray-600/20 text-gray-400"),children:e.status})]}),e.results&&(0,a.jsx)("div",{className:"mt-3 p-3 bg-gray-700/50 rounded",children:(0,a.jsx)("pre",{className:"text-sm text-gray-300 whitespace-pre-wrap",children:"string"==typeof e.results?e.results:JSON.stringify(e.results,null,2)})})]},e.id))})]})]})})}}}]);